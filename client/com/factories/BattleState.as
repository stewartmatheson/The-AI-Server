package com.factories {		import com.states.Battle;	import flash.display.Stage;	import com.models.*;	import com.views.*;	import flash.events.MouseEvent;	import com.controllers.PlayerBattleController;	import com.factories.*;		public class BattleState {				public static function create(mapData:Array, currentStage:Stage):Battle 		{			//first create the game map			var m:Map = Maps.createModel(mapData);			var mapView:MapView = Maps.createView(m);			var b:Battle = new Battle(currentStage);			b.setMap(m);			b.addView(mapView);						//now create the player controller and bind events to it			var playerController = b.getPlayerController();			for(var i:int = 0; i < mapView.getTiles().length; i++)			{				mapView.getTiles()[i].addEventListener(MouseEvent.MOUSE_OVER, playerController.displayTileInfo);				mapView.getTiles()[i].addEventListener(MouseEvent.MOUSE_OUT, playerController.hideTileInfo);			}						var firstPlayer:Player = Players.create(1, mapData);			var secondPlayer:Player = Players.create(2, mapData);						for(var j:int = 0; j < mapData["units"].length; j++)			{				var currentUnit:Unit = Units.createModel(mapData["units"][j], firstPlayer);				var currentUnitView:UnitView = Units.createView(currentUnit, mapView, currentStage, firstPlayer, b);								currentUnit = Units.createModel(mapData["units"][j], secondPlayer);				currentUnitView = Units.createView(currentUnit, mapView, currentStage, secondPlayer, b);			}			b.addPlayer(firstPlayer);			b.addPlayer(secondPlayer);			return b;		}	}}